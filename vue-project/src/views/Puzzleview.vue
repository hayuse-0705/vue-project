
<template>
    <div class="about">
      <h1>パズルを探そう！</h1>
      <!-- <ul v-html="puzzle_html" id="puzzle-frame"></ul> -->
<ul id="puzzle-frame"><ul><li class="peace-1"><img src="@/assets/puzzle_img/pease-01.png"  li=""></li><li class="peace-2"><img src="@/assets/puzzle_img/pease-02.png"  li=""></li><li class="peace-3"><img src="@/assets/puzzle_img/pease-03.png"  li=""></li><li class="peace-4"><img src="@/assets/puzzle_img/pease-04.png"  li=""></li><li class="peace-5"><img src="@/assets/puzzle_img/pease-05.png"  li=""></li><li class="peace-6"><img src="@/assets/puzzle_img/pease-06.png"  li=""></li><li class="peace-7"><img src="@/assets/puzzle_img/pease-07.png"  li=""></li><li class="peace-8"><img src="@/assets/puzzle_img/pease-08.png"  li=""></li><li class="peace-9"><img src="@/assets/puzzle_img/pease-09.png"  li=""></li></ul><ul><li class="peace-10"><img src="@/assets/puzzle_img/pease-10.png"  li=""></li><li class="peace-11"><img src="@/assets/puzzle_img/pease-11.png"  li=""></li><li class="peace-12"><img src="@/assets/puzzle_img/pease-12.png"  li=""></li><li class="peace-13"><img src="@/assets/puzzle_img/pease-13.png"  li=""></li><li class="peace-14"><img src="@/assets/puzzle_img/pease-14.png"  li=""></li><li class="peace-15"><img src="@/assets/puzzle_img/pease-15.png"  li=""></li><li class="peace-16"><img src="@/assets/puzzle_img/pease-16.png"  li=""></li><li class="peace-17"><img src="@/assets/puzzle_img/pease-17.png"  li=""></li><li class="peace-18"><img src="@/assets/puzzle_img/pease-18.png"  li=""></li></ul><ul><li class="peace-19"><img src="@/assets/puzzle_img/pease-19.png"  li=""></li><li class="peace-20"><img src="@/assets/puzzle_img/pease-20.png"  li=""></li><li class="peace-21"><img src="@/assets/puzzle_img/pease-21.png"  li=""></li><li class="peace-22"><img src="@/assets/puzzle_img/pease-22.png"  li=""></li><li class="peace-23"><img src="@/assets/puzzle_img/pease-23.png"  li=""></li><li class="peace-24"><img src="@/assets/puzzle_img/pease-24.png"  li=""></li><li class="peace-25"><img src="@/assets/puzzle_img/pease-25.png"  li=""></li><li class="peace-26"><img src="@/assets/puzzle_img/pease-26.png"  li=""></li><li class="peace-27"><img src="@/assets/puzzle_img/pease-27.png"  li=""></li></ul><ul><li class="peace-28"><img src="@/assets/puzzle_img/pease-28.png"  li=""></li><li class="peace-29"><img src="@/assets/puzzle_img/pease-29.png"  li=""></li><li class="peace-30"><img src="@/assets/puzzle_img/pease-30.png"  li=""></li><li class="peace-31"><img src="@/assets/puzzle_img/pease-31.png"  li=""></li><li class="peace-32"><img src="@/assets/puzzle_img/pease-32.png"  li=""></li><li class="peace-33"><img src="@/assets/puzzle_img/pease-33.png"  li=""></li><li class="peace-34"><img src="@/assets/puzzle_img/pease-34.png"  li=""></li><li class="peace-35"><img src="@/assets/puzzle_img/pease-35.png"  li=""></li><li class="peace-36"><img src="@/assets/puzzle_img/pease-36.png"  li=""></li></ul><ul><li class="peace-37"><img src="@/assets/puzzle_img/pease-37.png"  li=""></li><li class="peace-38"><img src="@/assets/puzzle_img/pease-38.png"  li=""></li><li class="peace-39"><img src="@/assets/puzzle_img/pease-39.png"  li=""></li><li class="peace-40"><img src="@/assets/puzzle_img/pease-40.png"  li=""></li><li class="peace-41"><img src="@/assets/puzzle_img/pease-41.png"  li=""></li><li class="peace-42"><img src="@/assets/puzzle_img/pease-42.png"  li=""></li><li class="peace-43"><img src="@/assets/puzzle_img/pease-43.png"  li=""></li><li class="peace-44"><img src="@/assets/puzzle_img/pease-44.png"  li=""></li><li class="peace-45"><img src="@/assets/puzzle_img/pease-45.png"  li=""></li></ul><ul><li class="peace-46"><img src="@/assets/puzzle_img/pease-46.png"  li=""></li><li class="peace-47"><img src="@/assets/puzzle_img/pease-47.png"  li=""></li><li class="peace-48"><img src="@/assets/puzzle_img/pease-48.png"  li=""></li><li class="peace-49"><img src="@/assets/puzzle_img/pease-49.png"  li=""></li><li class="peace-50"><img src="@/assets/puzzle_img/pease-50.png"  li=""></li><li class="peace-51"><img src="@/assets/puzzle_img/pease-51.png"  li=""></li><li class="peace-52"><img src="@/assets/puzzle_img/pease-52.png"  li=""></li><li class="peace-53"><img src="@/assets/puzzle_img/pease-53.png"  li=""></li><li class="peace-54"><img src="@/assets/puzzle_img/pease-54.png"  li=""></li></ul><ul><li class="peace-55"><img src="@/assets/puzzle_img/pease-55.png"  li=""></li><li class="peace-56"><img src="@/assets/puzzle_img/pease-56.png"  li=""></li><li class="peace-57"><img src="@/assets/puzzle_img/pease-57.png"  li=""></li><li class="peace-58"><img src="@/assets/puzzle_img/pease-58.png"  li=""></li><li class="peace-59"><img src="@/assets/puzzle_img/pease-59.png"  li=""></li><li class="peace-60"><img src="@/assets/puzzle_img/pease-60.png"  li=""></li><li class="peace-61"><img src="@/assets/puzzle_img/pease-61.png"  li=""></li><li class="peace-62"><img src="@/assets/puzzle_img/pease-62.png"  li=""></li><li class="peace-63"><img src="@/assets/puzzle_img/pease-63.png"  li=""></li></ul><ul><li class="peace-64"><img src="@/assets/puzzle_img/pease-64.png"  li=""></li><li class="peace-65"><img src="@/assets/puzzle_img/pease-65.png"  li=""></li><li class="peace-66"><img src="@/assets/puzzle_img/pease-66.png"  li=""></li><li class="peace-67"><img src="@/assets/puzzle_img/pease-67.png"  li=""></li><li class="peace-68"><img src="@/assets/puzzle_img/pease-68.png"  li=""></li><li class="peace-69"><img src="@/assets/puzzle_img/pease-69.png"  li=""></li><li class="peace-70"><img src="@/assets/puzzle_img/pease-70.png"  li=""></li><li class="peace-71"><img src="@/assets/puzzle_img/pease-71.png"  li=""></li><li class="peace-72"><img src="@/assets/puzzle_img/pease-72.png"  li=""></li></ul><ul><li class="peace-73"><img src="@/assets/puzzle_img/pease-73.png"  li=""></li><li class="peace-74"><img src="@/assets/puzzle_img/pease-74.png"  li=""></li><li class="peace-75"><img src="@/assets/puzzle_img/pease-75.png"  li=""></li><li class="peace-76"><img src="@/assets/puzzle_img/pease-76.png"  li=""></li><li class="peace-77"><img src="@/assets/puzzle_img/pease-77.png"  li=""></li><li class="peace-78"><img src="@/assets/puzzle_img/pease-78.png"  li=""></li><li class="peace-79"><img src="@/assets/puzzle_img/pease-79.png"  li=""></li><li class="peace-80"><img src="@/assets/puzzle_img/pease-80.png"  li=""></li><li class="peace-81"><img src="@/assets/puzzle_img/pease-81.png"  li=""></li></ul><ul><li class="peace-82"><img src="@/assets/puzzle_img/pease-82.png"  li=""></li><li class="peace-83"><img src="@/assets/puzzle_img/pease-83.png"  li=""></li><li class="peace-84"><img src="@/assets/puzzle_img/pease-84.png"  li=""></li><li class="peace-85"><img src="@/assets/puzzle_img/pease-85.png"  li=""></li><li class="peace-86"><img src="@/assets/puzzle_img/pease-86.png"  li=""></li><li class="peace-87"><img src="@/assets/puzzle_img/pease-87.png"  li=""></li><li class="peace-88"><img src="@/assets/puzzle_img/pease-88.png"  li=""></li><li class="peace-89"><img src="@/assets/puzzle_img/pease-89.png"  li=""></li><li class="peace-90"><img src="@/assets/puzzle_img/pease-90.png"  li=""></li></ul><ul><li class="peace-91"><img src="@/assets/puzzle_img/pease-91.png"  li=""></li><li class="peace-92"><img src="@/assets/puzzle_img/pease-92.png"  li=""></li><li class="peace-93"><img src="@/assets/puzzle_img/pease-93.png"  li=""></li><li class="peace-94"><img src="@/assets/puzzle_img/pease-94.png"  li=""></li><li class="peace-95"><img src="@/assets/puzzle_img/pease-95.png"  li=""></li><li class="peace-96"><img src="@/assets/puzzle_img/pease-96.png"  li=""></li><li class="peace-97"><img src="@/assets/puzzle_img/pease-97.png"  li=""></li><li class="peace-98"><img src="@/assets/puzzle_img/pease-98.png"  li=""></li><li class="peace-99"><img src="@/assets/puzzle_img/pease-99.png"  li=""></li></ul><ul><li class="peace-100"><img src="@/assets/puzzle_img/pease-100.png"  li=""></li><li class="peace-101"><img src="@/assets/puzzle_img/pease-101.png"  li=""></li><li class="peace-102"><img src="@/assets/puzzle_img/pease-102.png"  li=""></li><li class="peace-103"><img src="@/assets/puzzle_img/pease-103.png"  li=""></li><li class="peace-104"><img src="@/assets/puzzle_img/pease-104.png"  li=""></li><li class="peace-105"><img src="@/assets/puzzle_img/pease-105.png"  li=""></li><li class="peace-106"><img src="@/assets/puzzle_img/pease-106.png"  li=""></li><li class="peace-107"><img src="@/assets/puzzle_img/pease-107.png"  li=""></li><li class="peace-108"><img src="@/assets/puzzle_img/pease-108.png"  li=""></li></ul><ul><li class="peace-109"><img src="@/assets/puzzle_img/pease-109.png"  li=""></li><li class="peace-110"><img src="@/assets/puzzle_img/pease-110.png"  li=""></li><li class="peace-111"><img src="@/assets/puzzle_img/pease-111.png"  li=""></li><li class="peace-112"><img src="@/assets/puzzle_img/pease-112.png"  li=""></li><li class="peace-113"><img src="@/assets/puzzle_img/pease-113.png"  li=""></li><li class="peace-114"><img src="@/assets/puzzle_img/pease-114.png"  li=""></li><li class="peace-115"><img src="@/assets/puzzle_img/pease-115.png"  li=""></li><li class="peace-116"><img src="@/assets/puzzle_img/pease-116.png"  li=""></li><li class="peace-117"><img src="@/assets/puzzle_img/pease-117.png"  li=""></li></ul><ul><li class="peace-118"><img src="@/assets/puzzle_img/pease-118.png"  li=""></li><li class="peace-119"><img src="@/assets/puzzle_img/pease-119.png"  li=""></li><li class="peace-120"><img src="@/assets/puzzle_img/pease-120.png"  li=""></li><li class="peace-121"><img src="@/assets/puzzle_img/pease-121.png"  li=""></li><li class="peace-122"><img src="@/assets/puzzle_img/pease-122.png"  li=""></li><li class="peace-123"><img src="@/assets/puzzle_img/pease-123.png"  li=""></li><li class="peace-124"><img src="@/assets/puzzle_img/pease-124.png"  li=""></li><li class="peace-125"><img src="@/assets/puzzle_img/pease-125.png"  li=""></li><li class="peace-126"><img src="@/assets/puzzle_img/pease-126.png"  li=""></li></ul><ul><li class="peace-127"><img src="@/assets/puzzle_img/pease-127.png"  li=""></li><li class="peace-128"><img src="@/assets/puzzle_img/pease-128.png"  li=""></li><li class="peace-129"><img src="@/assets/puzzle_img/pease-129.png"  li=""></li><li class="peace-130"><img src="@/assets/puzzle_img/pease-130.png"  li=""></li><li class="peace-131"><img src="@/assets/puzzle_img/pease-131.png"  li=""></li><li class="peace-132"><img src="@/assets/puzzle_img/pease-132.png"  li=""></li><li class="peace-133"><img src="@/assets/puzzle_img/pease-133.png"  li=""></li><li class="peace-134"><img src="@/assets/puzzle_img/pease-134.png"  li=""></li><li class="peace-135"><img src="@/assets/puzzle_img/pease-135.png"  li=""></li></ul><ul><li class="peace-136"><img src="@/assets/puzzle_img/pease-136.png"  li=""></li><li class="peace-137"><img src="@/assets/puzzle_img/pease-137.png"  li=""></li><li class="peace-138"><img src="@/assets/puzzle_img/pease-138.png"  li=""></li><li class="peace-139"><img src="@/assets/puzzle_img/pease-139.png"  li=""></li><li class="peace-140"><img src="@/assets/puzzle_img/pease-140.png"  li=""></li><li class="peace-141"><img src="@/assets/puzzle_img/pease-141.png"  li=""></li><li class="peace-142"><img src="@/assets/puzzle_img/pease-142.png"  li=""></li><li class="peace-143"><img src="@/assets/puzzle_img/pease-143.png"  li=""></li><li class="peace-144"><img src="@/assets/puzzle_img/pease-144.png"  li=""></li></ul></ul>
      <!-- <div v-bind:class="{ active: flagclass.isActive, 'text-danger': flagclass.hasError }"><img src="../assets/puzzle_img/pease-01.png" alt=""></div> -->
    </div>
</template>


<script setup >
    // import { initializeApp } from 'firebase/app'
    // import { getFirestore, collection } from 'firebase/firestore'
    
    // ... other firebase imports
    import { ref , onMounted, VueElement , createApp} from 'vue'
    import {collection, onSnapshot , addDoc, doc, deleteDoc, updateDoc, getDocFromCache, loadBundle, QuerySnapshot} from 'firebase/firestore'
    import {db} from '@/firebase'     
    import { async } from '@firebase/util';

    const peacefoundsound = new Audio('./src/assets/se/newpiecefounded.mp3')

    const flagid = 1

    const puzzledataflag = collection(db,'puzzle-flag')

    const flagclass = ref({

    })
    // data:()=>({
    //     peacefoundsound :new Audio(require('@/assets/se/newpiecefounded.mp3'))
    // }),
    // create();{
    //     this.audio.currentTime = 0;
    // }

    // onMounted ( () => {
    //     onSnapshot(puzzledataflag, (querySnapshot) => {
    //         querySnapshot.forEach((doc) => {
    //             const todo ={
    //                 id:doc.id,
    //                 flag:doc.data().flag,
    //             }
    //         })
    //     })
    // })
    // var img_count = 0;
                
    //             var img_src ;
    //             var puzzle_peace_single ;
    //             var puzzle_all_peace ="" ;
    //             var puzzle_peace_row ="";
    //             var puzzle_all_row_peace ="";
                
    //             for(let u = 0 ; u<16 ; u++){
    //                 for(let i = 0 ; i<9 ; i++){
    //                     img_count= img_count + 1;
    //                     if(img_count <= 9){
    //                         img_src = "./src/assets/puzzle_img/pease-0" + img_count + ".png";
    //                     }else{
    //                         img_src = "./src/assets/puzzle_img/pease-" + img_count + ".png";
    //                     }
    //                     puzzle_peace_single = "<li ref='peace-" + img_count + "'><img src='" + img_src + "'</li>";
    //                     puzzle_peace_row = puzzle_peace_row + puzzle_peace_single;
    //                 }

    //                 puzzle_all_row_peace ="<ul>" + puzzle_all_row_peace + puzzle_peace_row + "</ul>";
    //                 puzzle_all_peace = puzzle_all_peace + puzzle_all_row_peace;
    //                 puzzle_all_row_peace="";
    //                 puzzle_peace_row = "";
    //             }
    //             // alert("ループ後");
    //             const puzzle_html = puzzle_all_peace;
            // img_link(){
            //     var img_count =0;
            //     img_count= img_count + 1;
            //     var img_src = require ("../assets/puzzle_img/pease-0" + img_count + ".png");
            //     var puzzle_peace_single = "<li><img src='" + img_src + "'</li>";
            //     var puzzle_all_peace = puzzle_all_peace + puzzle_peace_single;
            //     // document.getElementById("puzzle-columns").innerHTML=puzzle_all_peace;
            //     return img_src;
            // },
    //     const flagdata = await getDocFromCache(puzzledataflag);
    // // Document was found in the cache. If no cached document exists,
    // // an error will be returned to the 'catch' block below.
    //     console.log("Cached document data:", flagdata.data());
onMounted( ()=>{

        onSnapshot(puzzledataflag, (querySnapshot) => {
            peacefoundsound.play()
            // const listid = document.getElementById("puzzle-frame")
            // const idnum = doc.data().id
            // const puzzleflagdata = await getDocFromCache(puzzledataflag)
            // const peacenum = document.getElementsByClassName("peace-"+idnum)
            
            querySnapshot.forEach((doc) => {
                const values={
                    id:doc.id,
                    num:doc.data().id,
                    flag:doc.data().flag
                }
                const idnum = doc.data().id

                const peacenum = document.getElementsByClassName("peace-"+idnum)
                // const peacenum = document.getElementsByClassName("peace-"+idnum)as HTMLCollectionOf<HTMLElement>

                if(doc.data().flag==true){

                    peacenum[0].style.opacity = "1"

                }else{
                    peacenum[0].style.opacity = "0"
                }
                console.log("Current data: ", values)
            });
            
            // const test2 = listid.children[idnum]
            
            // console.log(peacenum)
            
            // if(doc.data().flag==true){

            //     peacenum[0].style.opacity = "1"

            // }else{
            //     peacenum[0].style.opacity = "0"
            // }
            // const puzzlepeace = "peace-0" + doc.data().id

            // if(doc.data().flag == true){
            //     this.$refs.puzzlepeace.style.opacity=1
            // }else{
            //     this.$refs.puzzlepeace.style.opacity=0
            // }
            
        });
              
})  

</script>

  <style>
  /* @media (min-width: 1024px) {
    .about {
      min-height: 100vh;
      display: flex;
      align-items: center;
    }
  } */
  #puzzle-frame img {
    width: 100%;
    height: 100%;
    margin: 0%;
    padding: 0%;
    object-fit: cover;
}
h1{
    text-align: center;
    color: #fff;
}
body{
    background-color: black;
}
#puzzle-frame{
    display: flex;
    gap: 0;
    padding: 0%;
    margin: 0%;
}
#puzzle-frame li{
    padding: 0%;
    margin: 0%;
    list-style: none;
    opacity: 0;
    width: 100%;
    line-height: 0%;
    transition: 1s;
}
 #puzzle-frame li::before{
    content: '';
    line-height: 0%;
    margin: 0;
    height: 0;
}  
#puzzle-frame li::after{
    content: '';
    line-height: 0%;
    margin: 0;
    height: 0;
}  
#puzzle-frame ul{
    padding: 0%;
    margin: 0%;
}
/* .peace-118{
    opacity: 0; 
} */
.active{
    opacity:1;
}
.text-danger{
    opacity: 0;
}
nav{
    display: none;
}
  </style>